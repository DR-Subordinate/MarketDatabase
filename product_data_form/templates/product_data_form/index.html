{% extends "product_data_form/base.html" %}

{% block content %}
  <div class="flex">
    <section class="border border-black">
      <h1 class="text-3xl text-blue-500">市場</h1>
      <form method="post">
        {% csrf_token %}
        {% if error_message %}<p><strong>{{ error_message }}</strong></p>{% endif %}
        <fieldset>
          日付: {{ market_form.date.errors }} {{ market_form.date }}<br>
          市場名: {{ market_form.name.errors }} {{ market_form.name }}<br>
          <input type="submit" name="save_market" value="市場を保存" class="border border-black">
        </fieldset>
      </form>
    </section>
  </div>

  <section>
    {% for market in markets %}
      <h1>{{ market.name }} {{ market.date }}</h1>
      <table class="mx-auto border border-black">
        <thead>
          <tr class="bg-gray-300">
            <th class="p-2 border border-black">番号</th>
            <th class="p-2 border border-black">ブランド名</th>
            <th class="p-2 border border-black">商品名</th>
            <th class="p-2 border border-black">型番</th>
            <th class="p-2 border border-black">製造番号</th>
            <th class="p-2 border border-black">素材・カラー</th>
            <th class="p-2 border border-black">状態</th>
            <th class="p-2 border border-black">詳細・備考</th>
            <th class="p-2 border border-black">値段</th>
          </tr>
        </thead>
        <tbody>
          {% for product in market.product_set.all %}
            {% if product.price and not product.winning_bid %}
              <tr>
                <td class="p-2 border border-black">{{ product.number}}</td>
                <td class="p-2 border border-black">{{ product.brand_name}}</td>
                <td class="p-2 border border-black">{{ product.name}}</td>
                <td class="p-2 border border-black">{{ product.model_number}}</td>
                <td class="p-2 border border-black">{{ product.serial_number}}</td>
                <td class="p-2 border border-black">{{ product.material_color}}</td>
                <td class="p-2 border border-black">{{ product.condition}}</td>
                <td class="p-2 border border-black">{{ product.detail}}</td>
                <td class="p-2 border border-black">{{ product.price}}</td>
              </tr>
            {% endif %}
          {% endfor %}
        </tbody>
      </table>
    {% endfor %}
  </section>
{% endblock %}
